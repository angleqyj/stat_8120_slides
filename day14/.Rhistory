wrap<-function(x, mu, sigma=.1){
termini = trunc(5*sigma + 2)
s = sum(dnorm(x + (-termini):termini, mu, sigma))
return(s)}
trunc(5*sigma + 2)
trunc(5*1 + 2)
dnorm(x + (-termini):termini, 0, 1)
taylor_wrap <- function(x,mu, sigma=.1){
termini = trunc(5*sigma + 2)
log_phis <- dnorm(x + (-termini):termini, mu, sigma, log = T)
m <- max(log_phis)
return(m + log(sum(exp(log_phis - m))))
}
taylor_wrap(0,0,.1)
wrap(0,0, .1)
taylor_wrap <- function(x,mu, sigma=.1){
termini = trunc(5*sigma + 2)
log_phis <- dnorm(x + (-termini):termini, mu, sigma, log = T)
#m <- max(log_phis)
m <- 0
return(m + log(sum(exp(log_phis - m))))
}
taylor_wrap(0,0,.1)
taylor_wrap <- function(x,mu, sigma=.1){
termini = trunc(5*sigma + 2)
log_phis <- dnorm(x + (-termini):termini, mu, sigma, log = T)
#m <- max(log_phis)
m <- 0
return(m + log(sum(exp(log_phis - m))))
}
taylor_wrap(0,0,.1)
taylor_wrap <- function(x,mu, sigma=.1){
termini = trunc(5*sigma + 2)
log_phis <- dnorm(x + (-termini):termini, mu, sigma, log = T)
m <- max(log_phis)
#m <- 0
return(m + log(sum(exp(log_phis - m))))
}
taylor_wrap(0,0,.1)
wrap(0,0,.1)
wrap<-function(x, mu, sigma=.1){
termini = trunc(5*sigma + 2)
s = sum(dnorm(x + (-termini):termini, mu, sigma))
return(s)}
taylor_wrap <- function(x,mu, sigma=.1){
termini = trunc(5*sigma + 2)
log_phis <- dnorm(x + (-termini):termini, mu, sigma, log = T)
m <- max(log_phis)
return(m + log(sum(exp(log_phis - m))))
}
taylor_wrap(0,0,.1)
wrap(0,0,.1)
taylor_wrap <- function(x,mu, sigma=.1){
termini = trunc(5*sigma + 2)
log_phis <- dnorm(x + (-termini):termini, mu, sigma, log = T)
m <- max(log_phis)
exp(m + log(sum(exp(log_phis - m)))})
taylor_wrap <- function(x,mu, sigma=.1){
termini = trunc(5*sigma + 2)
log_phis <- dnorm(x + (-termini):termini, mu, sigma, log = T)
m <- max(log_phis)
exp(m + log(sum(exp(log_phis - m)))) }
taylor_wrap(0,0,.1)
wrap(0,0,.1)
taylor_wrap(200,0,.1)
wrap(200,0,.1)
taylor_wrap <- function(x,mu, sigma=.1){
termini = trunc(100*sigma + 2)
log_phis <- dnorm(x + (-termini):termini, mu, sigma, log = T)
m <- max(log_phis)
exp(m + log(sum(exp(log_phis - m)))) }
taylor_wrap(200,0,.1)
wrap(200,0,.1)
taylor_wrap <- function(x,mu, sigma=.1){
termini = trunc(5*sigma + 2)
log_phis <- dnorm(x + (-termini):termini, mu, sigma, log = T)
m <- max(log_phis)
exp(m + log(sum(exp(log_phis - m)))) }
taylor_wrap(200,0,.1)
wrap(200,0,.1)
taylor_wrap(0,0,.1)
wrap(0,0,.1)
qnorm(p=.975)
za2 <- qnorm(p=.975)
2 - za2*sqrt(2/100)
2 + za2*sqrt(2/100)
